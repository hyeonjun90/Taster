<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>

<sqlMap>
	<typeAlias alias="myPageList" type="bean.JoinR_B_S"/>
	
	<resultMap id="myPageRes" class="myPageList">
		<result property="review_idx" column="review_idx"/>
		<result property="r_title" column="r_title"/>
		<result property="r_content" column="r_content"/>
		<result property="r_score" column="r_score"/>
		<result property="r_pungga" column="r_pungga"/>
		<result property="r_image" column="r_image"/>
		<result property="r_regdate" column="r_redate"/>
		<result property="member_id" column="member_id"/>
		<result property="shop_idx" column="shop_idx"/>
		<result property="bookmark_idx" column="bookmark_idx"/>
		<result property="shop_name" column="shop_name"/>
		<result property="shop_tel" column="shop_tel"/>
		<result property="shop_kind" column="shop_kind"/>
		<result property="shop_addr1" column="shop_addr1"/>
		<result property="shop_addr2" column="shop_addr2"/>
		<result property="shop_addr3" column="shop_addr3"/>
		<result property="shop_addr4" column="shop_addr4"/>
		<result property="shop_price" column="shop_price"/>
		<result property="shop_holiday" column="shop_holiday"/>
		<result property="shop_readCount" column="shop_readCount"/>
		<result property="shop_new" column="shop_new"/>
	</resultMap>
	
	<!--reviewList select문 선언 -->
	<select id="reviewList-selectAll" resultMap="myPageRes" parameterClass="String">
		select r_image, shop_name from review r inner join shop s on r.shop_idx=s.shop_idx
		where member_id=#member_id# order by review_idx desc
	</select>
	
	<select id="idCheck" parameterClass="String" resultClass="Integer">
		select count(*) from Member where member_id=#member_id#
	</select>
	
	<insert id="insertMember" parameterClass="bean.MemberBean">
		insert into MEMBER(member_id, member_pwd, member_nicname, member_name, member_phone,
				member_addr, member_zipcdoe, member_image, member_joindate, member_level)
			values(#member_id#, #member_pwd#, #member_nicname#, #member_name#, #member_phone#,
				#member_addr#, #member_zipcode#, #member_image#, #member_joinDate#, default)
	</insert>
	
	<select id="zipcodeSearch" parameterClass="String" resultClass="bean.ZipcodeBean">
		select * from zipcode where dong like #keyword#
	</select>
	
	<select id="pwdCheck" parameterClass="String" resultClass="String">
		select member_pwd from member where member_id=#member_id#
	</select>
	
	<select id="getMemberInfo" parameterClass="String" resultClass="bean.MemberBean">
		select member_id, member_nicname, member_level from member where member_id=#member_id#
	</select>

   
	<!-- bookmarkList select문 선언 -->
	<select id="bookmarkList-selectAll" resultMap="myPageRes" parameterClass="String">
		select r_image, shop_name from review r left join shop s on r.shop_idx=s.shop_idx
		left join bookmark b on r.shop_idx=b.shop_idx 
		where member_id = #member_id#
		order by bookmark_idx DESC, review_idx desc
	</select>
</sqlMap>
