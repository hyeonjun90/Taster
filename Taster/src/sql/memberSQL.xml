<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>

<sqlMap>
	
	<select id="memberIdCheck" parameterClass="String" resultClass="Integer">
		select count(*) from Member where member_id=#member_id#
	</select>
	<select id="nicCheck" parameterClass="String" resultClass="Integer">
		select count(*) from Member where member_nicname=#member_nicname#
	</select>
	
	<insert id="insertMember" parameterClass="bean.MemberBean">
		insert into MEMBER(member_id, member_pwd, member_nicname, member_name, member_phone,
				member_addr, member_zipcdoe, member_image, member_joindate, member_level, member_email)
			values(#member_id#, #member_pwd#, #member_nicname#, #member_name#, #member_phone#,
				#member_addr#, #member_zipcode#, #member_image#, #member_joinDate#, default, #member_email#)
	</insert>
	
	<select id="zipcodeSearch" parameterClass="String" resultClass="bean.ZipcodeBean">
		select * from zipcode where dong like #keyword#
	</select>
	
	<select id="pwdCheck" parameterClass="String" resultClass="String">
		select member_pwd from member where member_id=#member_id#
	</select>
	
	<select id="getMemberInfo" parameterClass="String" resultClass="bean.MemberBean">
		select member_id, member_nicname, member_level from member where member_id=#member_id#
	</select>
	<!-- 아이디/비번 찾기 -->
	<select id="findMemberId" parameterClass="String" resultClass="String">
		select member_id from member where member_email=#member_email#
	</select>
	<select id="findMemberPwd" parameterClass="String" resultClass="String">
		select member_pwd from member where member_email=#member_email#
	</select>

   <!-- 테스트 코드 -->
   <select id="test" resultClass="bean.PositionBean">
      select * from Member_Position where p_idx=1
   </select>
   
   <!-- bookmarkList select문 선언 -->
   <select id="bookmarkList-selecAll" resultClass="bean.BookmarkListBean" parameterClass="String">
   		select shop_name, file_savname from bookmark b left join shop s on b.shop_idx=s.shop_idx
   		where member_id = #member_id#
   		order by s.shop_idx DESC
   </select>
   
   <!--reviewList select문 선언 -->
   <select id="reviewList-selectAll" resultClass="bean.ReviewListBean" parameterClass="String">
   		select shop_name, file_savname from review r inner join shop s on r.shop_idx=s.shop_idx
   		where member_id = #member_id#
   		order by s.shop_idx DESC
   </select>
   
   <!-- 마이펭지 페이징에 사용될 리스트 카운터 -->
   	<select id="reviewListCount" resultClass="Integer" parameterClass ="String">
		select count(*) from review where member_id = #member_id#
	</select>
	
		<select id="bookmarkListCount" resultClass="Integer" parameterClass ="String">
		select count(*) from bookmark where member_id = #member_id#
	</select>
	
</sqlMap>
